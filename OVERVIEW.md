# AMExplorer

  

![enter image description here](https://github.com/Malware-Hunter/SF23-AMExplorer/blob/main/images/amexplorer.jpeg)

  

## Overview

  

This repository houses AMExplorer, an innovative tool for generating datasets. Through the integration of metadata from different sources, such as AndroGuard, which makes it possible to extract information such as application names, permissions and API calls, along with obtaining data from APKs from AndroZoo and scan reports from VirusTotal, this tool produces three distinct types of datasets. These sets encompass comprehensive metadata about applications, binary and discrete information, all built to be used in a variety of contexts, from machine learning enhancement to malware analysis.

## Directories

- androzoo: Contains a list of apps selected from AndroZoo.
  - (1) CSV File: CSV file containing APK information.
- androguard: Contains features and metadata extracted using the AndroGuard library.
  - (2) features: JSON files representing extracted features.
  - (3) metadata: JSON files containing metadata information.
- virustotal: Contains APKs scanners to detect malware and other security breaches.
  - (4) JSON files: with scan reports from VirusTotal.

File Tree:
```
├── androguard
│   ├── features
│   │   └── JSON files
│   └── metadata
│   │   └── JSON files
├── androzoo
│   └── CSV File
├── virustotal
│   └── JSON Files
```
  
These metadata files are generated from the AMGenerator tool [AMGenerator tool](https://github.com/Malware-Hunter/SF23-AMGenerator/blob/main/OVERVIEW.md)

# Example of datasets generated by the tool

## Metadata dataset (Continuous):

| VT_LAST_ANALYSIS_DATE | VT_SIZE  | SHA256                                                           | VT_MD5                           | VT_TIMES_SUBMITTED | VT_SCANNERS_FAILURE | VT_SCANNERS_MALICIOUS | VT_SCANNERS_UNDETECTED | VT_SCANNERS_SUGGESTED_THREAT_LABEL | VT_CLASS_SCANNERS | VT_SCANNERS_NAMES                               | AZ_DETECTION | AZ_SCAN_DATE        | AZ_MARKETS      | AG_PERMISSIONS                       | AG_ACTIVITIES                                           | AG_SERVICES                                    | AG_RECEIVERS                                         | AG_PROVIDERS                                              | AG_INTENTS                | AG_OPCODES                  | AG_APICALLS                             | AG_APP_NAME          | AG_PACKAGE                          | AG_TARGET_API | AG_MIN_API |
| --------------------- | -------- | ---------------------------------------------------------------- | -------------------------------- | ------------------ | ------------------- | --------------------- | ---------------------- | ---------------------------------- | ----------------- | -----------------                               | ------------ | ------------------- | --------------- | ------------------------------------ | ------------------------------------------------------- | -----------------------------------------------| ---------------------------------------------------- | --------------------------------------------------------- | ------------------------- | --------------------------- | ----------------------------------------| ---------------------| ----------------------------------- | ------------- | ---------- |
| 2023-05-15 09:26:08   | 11911401 | E1961600C4941901272E8EC4B8CD10ABD29678981CB13EE0AA89B289D8587BF1 | 7e36a078909b0f6f0f9c43bf77a09419 | 1                  | 0                   | 0                     | 63                     |                                    | 0                 | []                                              | 0            | 2023-05-15 09:26:08 | play.google.com | ['WRITE_SETTINGS'...]                | ['com.startapp.sdk.ads.list3d.List3DActivity']...       | ['com.ryanheise.audioservice.AudioService']... | ['com.ryanheise.audioservice.MediaButtonReceiver', ] | ['vn.hunghd.flutterdownloader.DownloadedFileProvider']... | ['DEVICE_STORAGE_OK',]... | {'invoke-direct': 71245}... | {'Ljava.nio.ByteBuffer.getInt': 2}...   | Basketball Team Race |	com.adwhirl.basketballteamracedd |	8	         |   8        |
| 2023-02-02 12:58:38	|3347706   |E19618CA5A317F139BAAE981AF0E41625AABB27424AA9832CF0B4F4E0D036187  |	09c6829d9efb2914f6b4d437a4b46b3a | 3                  |	0                   | 28                    | 38	                 |adware.waps/gappusin	              | 1                 |	['McAfee'... 'Microsoft', 'Google'] ...         | 10	       | 2011-11-09 15:40:00 | appchina        | ['ACCESS_MEDIA_LOCATION'...]         | ['com.h2.dynamic_app.MainActivity'...]                  | ['com.ryanheise.audioservice.AudioService'] ...| ['com.ryanheise.audioservice.MediaButtonReceiver', ] | ['androidx.startup.InitializationProvider']...            | ['TIME_SET']...           | {'invoke-static': 80428}... | {'Ljava.nio.ByteBuffer.getShort': 2}... | suppressed	       |com.wangwei.al.livewallpaper	     | 7             |	7		  |


The metadata dataset contains information from various sources, each identified by a prefix in the column name. Here is an explanation of each column:

- **VT_LAST_ANALYSIS_DATE:** The date when the APK was last analyzed by VirusTotal.

- **VT_SIZE:** The size of the APK file, as reported by VirusTotal (in bytes).

- **SHA256:** The SHA256 hash value of the APK file, a unique identifier.

- **VT_MD5:** The MD5 hash value of the APK file, as reported by VirusTotal.

- **VT_TIMES_SUBMITTED:** The number of times the APK has been submitted to VirusTotal for analysis.

- **VT_SCANNERS_FAILURE:** The number of scanners in VirusTotal that reported a failure during the analysis of the APK.

- **VT_SCANNERS_MALICIOUS:** The number of scanners in VirusTotal that classified the APK as malicious.

- **VT_SCANNERS_UNDETECTED:** The number of scanners in VirusTotal that did not detect any threats in the APK.

- **VT_SCANNERS_SUGGESTED_THREAT_LABEL:** VirusTotal's suggested threat label for the APK based on the analysis results.

- **VT_SCANNERS_NAMES:** The names of individual scanners used in the VirusTotal analysis.

- **AZ_DETECTION:** The detection status of the APK in Androzoo, indicating whether it's classified as malicious or not.

- **AZ_SCAN_DATE:** The date when the APK was scanned or collected in Androzoo.

- **AZ_MARKETS:** Information about the markets from which the APK was collected in Androzoo.

- **AG_PERMISSIONS:** The permissions requested by the APK, extracted using the Androguard library.

- **AG_ACTIVITIES:** The activities defined in the APK, extracted using the Androguard library.

- **AG_SERVICES:** The services defined in the APK, extracted using the Androguard library.

- **AG_RECEIVERS:** The receivers defined in the APK, extracted using the Androguard library.

- **AG_PROVIDERS:** The content providers defined in the APK, extracted using the Androguard library.

- **AG_INTENTS:** The intents used in the APK, extracted using the And

roguard library.

- **AG_OPCODES:** The opcodes (operation codes) present in the APK's Dalvik bytecode, extracted using the Androguard library.

- **AG_APICALLS:** The API calls made by the APK, extracted using the Androguard library.

- **AG_APP_NAME:** The name of the APK's application, extracted using the Androguard library (names that do not belong to the ASCII standard will be displayed as suppressed).

- **AG_PACKAGE:** The package name of the APK, extracted using the Androguard library.

- **AG_TARGET_API:** The target API level of the APK.

- **AG_MIN_API:** The minimum required API level for the APK to run.



## Discrete dataset

The discrete dataset includes the application identifier represented by SHA256 and a classification column named VT_CLASS_SCANNERS with "1" for malware and "0" for benign, based on the threshold used. Each feature is represented by a prefix that identifies it (e.g., PERMISSION_, ACTIVITIE_, SERVICE_, RECEIVER_, PROVIDER_, INTENT_, OPCODE_, APICALL_). An application may contain 0 or more features, which determines the number of columns in the dataset. It is important to note that in this discrete dataset, the OPCODE and APICALL columns can contain any integer value.

| SHA256                        | VT_CLASS_SCANNERS | PERMISSION_CAMERA | PERMISSION_LOCATION | ACTIVITIE_MAIN | SERVICE_NETWORK | OPCODE_invoke-direct | APICALL_Landroid.util.SparseArray.append |
|-------------------------------|-------------------|---------------------|----------------------|-----------------|------------------|--------------|---------------|
| 0123456789abcdef0123456789abcd | 1                 | 1                   | 0                    | 1               | 1                | 53            | 100            |
| abcdef0123456789abcdef01234567 | 0                 | 0                   | 1                    | 1               | 0                | 8            | 50             |


## Binary Dataset

The binary dataset includes the application identifier represented by SHA256 and a classification column called VT_CLASS_SCANNERS with "1" for malware and "0" for benign, based on the threshold used. Each feature is represented by a prefix that identifies it (e.g., PERMISSION_, ACTIVITY_, SERVICE_, RECEIVER_, PROVIDER_, INTENT_, OPCODE_, APICALL_). An application may contain 0 or more features, which determines the number of columns in the dataset. It is important to note that in this binary dataset, the OPCODE and APICALL columns should only take the values 0 or 1, where 1 represents the occurrence of a specific feature, and 0 represents the absence of that feature.

| SHA256                        | VT_CLASS_SCANNERS | PERMISSION_CAMERA | PERMISSION_LOCATION | ACTIVITIE_MAIN | SERVICE_NETWORK | OPCODE_invoke-direct | APICALL_Landroid.util.SparseArray.append |
|-------------------------------|-------------------|---------------------|----------------------|-----------------|------------------|--------------|---------------|
| 0123456789abcdef0123456789abcd | 1                 | 1                   | 0                    | 1               | 1                | 0            | 1            |
| abcdef0123456789abcdef01234567 | 0                 | 0                   | 1                    | 1               | 0                | 1            | 0             |
